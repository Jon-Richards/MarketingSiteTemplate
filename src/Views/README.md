# Views Library

A unified Razor class library combining server-side Razor components with client-side React/TypeScript and Tailwind CSS styling.

## Project Structure

```
Views/
├── Server/              # Razor components for server-side rendering
│   ├── Pages/          # Razor pages
│   └── Components/     # Razor components
├── Client/             # React/TypeScript components
│   ├── features/       # Feature-based modules
│   ├── components/     # Reusable React components
│   ├── pages/          # Page components
│   ├── styles/         # CSS files (Tailwind)
│   ├── App.tsx         # Root component
│   └── main.tsx        # React entry point
├── wwwroot/
│   ├── bundle/         # Built/bundled assets (Vite output)
│   │   ├── css/
│   │   ├── js/
│   │   └── ...
│   └── static/         # Static assets (committed to git)
│       ├── images/
│       ├── fonts/
│       └── lib/
└── Configuration files
    ├── Views.csproj    # .NET Razor class library
    ├── vite.config.ts  # Vite build configuration
    ├── tailwind.config.js
    ├── tsconfig.json
    ├── package.json
    └── ...
```

## Architecture

### Single Unified Project
- **Views.csproj**: Razor class library targeting net9.0
- **One build pipeline**: Both Server and Client assets built together
- **Shared styling**: Tailwind CSS scans both Razor and React templates

### Build Output
- **wwwroot/bundle/**: Generated by Vite (Razor expects wwwroot/)
  - Never commit to git - regenerated on each build
- **wwwroot/static/**: Hand-crafted static assets
  - Committed to git
  - Images, fonts, and other libraries that rarely change

### Development Workflow

#### Prerequisites
```bash
# In the Views directory
npm install
```

#### Local Development
```bash
# Terminal 1: Run Vite dev server (watches Client/ for changes)
npm run dev

# Terminal 2: In root of workspace, run dotnet host
dotnet run --project src/Site
```

#### Building
```bash
# Build for production
npm run build

# This generates wwwroot/bundle/ with minified assets
```

## Configuration Files

### Views.csproj
Razor class library project file. Targets net9.0 with Razor SDK.

### vite.config.ts
Configures Vite to:
- Build React/TypeScript from `Client/` folder
- Output to `wwwroot/bundle/`
- Set up TypeScript path aliases for clean imports

### tailwind.config.js
Scans:
- `Server/**/*.razor` - Razor components
- `Client/**/*.{ts,tsx}` - React/TypeScript components

Generates CSS that works for both server and client rendering.

### package.json
Contains npm scripts and dev dependencies:
- **npm run dev**: Start Vite dev server
- **npm run build**: Production build to `wwwroot/bundle/`

### TypeScript Configuration
- `tsconfig.json`: Main TypeScript config with path aliases
- `tsconfig.node.json`: Config for Vite and build tools

### Code Quality
- `.eslintrc.js`: ESLint configuration for TypeScript/React
- `.prettierrc.json`: Code formatting rules
- `stylelint.config.js`: CSS/Tailwind linting

## Getting Started

### 1. Install Dependencies
```bash
cd src/Views
npm install
```

### 2. Start Development
```bash
# Terminal 1: Run Vite dev server
npm run dev

# Terminal 2 (in workspace root): Run ASP.NET Core host
dotnet run --project src/Site
```

The Vite dev server runs on `http://localhost:5173` (or next available port).

### 3. Create Components

#### Server-side Razor Component
Create `Server/Components/MyComponent.razor`:
```razor
<div class="p-4 bg-blue-100">
    <h1 class="text-lg font-bold">Hello from Razor</h1>
</div>

@code {
    // Component logic
}
```

#### Client-side React Component
Create `Client/components/MyButton.tsx`:
```typescript
import React from 'react';

export function MyButton() {
  return (
    <button className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
      Click me
    </button>
  );
}
```

## Styling with Tailwind

Both Razor and React components can use Tailwind CSS classes:

```razor
<!-- In Razor -->
<div class="flex items-center justify-center h-screen bg-gradient-to-r from-blue-500 to-purple-600">
</div>
```

```typescript
// In React
<div className="flex items-center justify-center h-screen bg-gradient-to-r from-blue-500 to-purple-600">
</div>
```

## Build & Deployment

### Local Build
```bash
npm run build
```

Generates `wwwroot/bundle/` with minified JavaScript and CSS.

### Deployment
When publishing with `dotnet publish`:
1. Vite build is triggered (if integrated in .csproj)
2. All assets in `wwwroot/` (both `bundle/` and `static/`) are packaged
3. Host serves assets directly from wwwroot

### Environment Variables
Create `.env.local` in the Views folder for dev-only settings:
```
VITE_API_URL=http://localhost:5000
```

Access in React:
```typescript
const apiUrl = import.meta.env.VITE_API_URL;
```

## Git Workflow

### Commit These
- All source code (`Server/`, `Client/`)
- Configuration files (`vite.config.ts`, `tailwind.config.js`, etc.)
- Static assets (`wwwroot/static/`)
- `package.json` and `package-lock.json`

### Don't Commit These
- `node_modules/` - regenerated on `npm install`
- `wwwroot/bundle/` - regenerated on `npm run build`
- `.env.local` - local environment only

See [.gitignore](.gitignore) for full list.

## TypeScript Path Aliases

Use these shortcuts for cleaner imports:

```typescript
// Instead of:
import Button from '../../../components/Button';

// Use:
import Button from '@components/Button';
```

Available aliases:
- `@components/` → `./Client/components/`
- `@pages/` → `./Client/pages/`
- `@features/` → `./Client/features/`
- `@styles/` → `./Client/styles/`

## Troubleshooting

### Port 5173 already in use
Vite automatically uses the next available port (5174, 5175, etc.).

### Tailwind styles not showing
- Ensure `npm run build` was run
- Check `tailwind.config.js` includes your template paths
- Verify CSS is imported in `Client/main.tsx`

### TypeScript errors on import
- Verify path aliases in `tsconfig.json`
- Check file extensions (.tsx, .ts)
- Ensure `tsconfig.json` is in the Views root

## Learn More

- [Vite Documentation](https://vitejs.dev/)
- [React Documentation](https://react.dev/)
- [Tailwind CSS Documentation](https://tailwindcss.com/)
- [Razor Components](https://learn.microsoft.com/en-us/aspnet/core/razor-components/)
